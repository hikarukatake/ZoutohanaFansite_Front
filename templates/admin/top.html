<!-- 【管理者TOP】 -->
<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理者TOP</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="../../static/css/admin/admin-style.css" th:href="@{/css/admin/admin-style.css}">
</head>
<body>
    <div th:replace="~{layout-admin :: header}"></div>

    <main id="admin-main">
        <h1 class="page-title">開催中の企画</h1>

        <div class="main-content mt-4" th:each="project : ${projects}"> <!-- 企画カードを並べる部分 -->
            <div class="main-content-card p-8 mt-2"> <!-- 企画カード -->
                <div class="table-border-b-strong pb-4"> <!-- 企画カードヘッダー -->
                    <h2 class="review-card-title icon-center">
                        <span th:text="${project.name}">企画名が取得できませんでした</span>
                    </h2>
                    <p class="review-card-sub-info ml-4">
                        <span>
                            https://zoutohana-fansite.jp/project/<span class="text-black" th:text="${project.urlKey}">URL-key</span>
                        </span>
                        <button
                            type="button"
                            class="btn-sm"
                            th:data-url="'https://zoutohana-fansite.jp/project/' + ${project.urlKey}">
                            <span class="material-symbols-outlined font-sm">content_copy</span>
                        </button>
                    </p>
                </div>

                <div class="py-4 table-border-b-strong"> <!-- 企画カードボディ -->
                    <ul class="progressbar"> <!-- 進捗部分 -->
                        <li th:classappend="${project.status.getOrder() >= 1} ? 'complete'">投稿期間前</li>
                        <li th:classappend="${project.status.getOrder() >= 2} ? 'complete'">投稿期間中</li>
                        <li th:classappend="${project.status.getOrder() >= 3} ? 'complete'">一次審査</li>
                        <li th:classappend="${project.status.getOrder() >= 4} ? 'complete'">二次審査</li>
                        <li th:classappend="${project.status.getOrder() >= 5} ? 'complete'">ノミネート決定</li>
                        <li th:classappend="${project.status.getOrder() >= 6} ? 'complete'">大賞決定</li>
                    </ul>
                    <div class="flex"> <!-- 画像・日付等情報(flex) -->
                        <img src="../../static/img/NO-IMAGE.png" th:src="@{/api/images/project.main_img_url}" class="project-card-thumbnail">
                        <div class="mb-auto pl-4">
                            <h3 class="page-title-sub">
                                <span th:text="${#temporals.format(project.projectStartAt, 'yyyy/MM/dd HH:mm')}">2025/01/01 12:00</span>
                                <span>~</span>
                                <span th:text="${#temporals.format(project.projectEndAt, 'yyyy/MM/dd HH:mm')}">2025/01/01 12:00</span>
                            </h3>
                            <table>
                                <tr>
                                    <th>書評投稿期間 : </th>
                                    <td>
                                        <span th:text="${#temporals.format(project.submissionStartAt, 'yyyy/MM/dd HH:mm')}">2025/01/01 12:00</span>
                                        <span>~</span>
                                        <span th:text="${#temporals.format(project.submissionEndAt, 'yyyy/MM/dd HH:mm')}">2025/01/01 12:00</span>
                                    </td>
                                </tr>
                                <tr>
                                    <th>書評投票期間 : </th>
                                    <td>
                                        <span th:text="${#temporals.format(project.votingStartAt, 'yyyy/MM/dd HH:mm')}">2025/01/01 12:00</span>
                                        <span>~</span>
                                        <span th:text="${#temporals.format(project.votingEndAt, 'yyyy/MM/dd HH:mm')}">2025/01/01 12:00</span>
                                    </td>
                                </tr>
                                <tr>
                                    <th>投稿された書評 : </th>
                                    <td><span th:text="${project.reviewCount}">123</span>件</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="pt-4 flex justify-between"> <!-- 企画カードフッター -->
                    <div> <!-- 左側 -->
                        <button type="button" class="btn">次のステータス(<span>投票期間中</span>)に進める</button>  <!-- TODO:後で考える -->
                        <button type="button" class="btn btn-danger" data-modal-target="delete-confirm-modal">削除する</button>
                    </div>
                    <a href="project_edit.html" th:href="@{/project_edit/{urlKey}(urlKey=${project.urlKey})}" class="icon-center review-card-sub-info text-decoration-none">詳細を確認する<span class="material-symbols-outlined">double_arrow</span></a>
                </div>
            </div>
        </div>
    </main>

    <div id="delete-confirm-modal" class="modal">
        <div>
            <div class="modal-content">
                <div class="flex justify-between items-start">
                    <h2 class="page-title mx-auto">注意</h2>
                    <span class="modal-close"><span class="material-symbols-outlined">close</span></span>
                </div>

                <div class="mt-8">
                    <p>この企画を削除すると、<span class="font-bold underline">関連するすべての書評データも同時に削除されます。</span></p>
                    <p><span class="font-bold underline text-danger">削除したデータは復元できません。</span></p>
                    <p class="mt-4">削除を実行するには、以下の入力欄に企画URLを入力してください。</p>
                </div>

                <div class="mt-8">
                    <p>企画URL : <span th:text="${project.urlKey}">URL-key</span></p>
                    <form th:action="@{/project/delete}" method="post">
                        <input type="hidden" name="projectId" th:value="${project.id}">
                        <input type="text" class="input-text w-full" th:placeholder="${project.urlKey}">
                        <div class="btn-wrap mt-8">
                            <button type="submit" class="btn btn-danger"><span class="px-8">削除する</span></button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="../../static/js/admin/admin-general.js" th:src="@{/js/admin/admin-general.js}"></script>
    <!-- TODO:利用者アカウント一覧では読み込めてるのにTOPでは読み込めない -->
</body>
</html>
